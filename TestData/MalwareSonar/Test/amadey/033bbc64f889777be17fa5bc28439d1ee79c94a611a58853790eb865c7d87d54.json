{
    "version": "0.2.3",
    "sample": {
        "id": "230321-rvg93ada41",
        "score": 10,
        "target": "033bbc64f889777be17fa5bc28439d1ee79c94a611a58853790eb865c7d87d54.zip",
        "size": 1074704,
        "md5": "c21780642c720c1f8abf585e6ad3e0ee",
        "sha1": "00977f266219faf1aa1879f7213bf4931d7f16bc",
        "sha256": "591dc1de5fa44eb8ff1aa051e47064b70b3777bcead66b2a99d7ea0be99a9e3e",
        "sha512": "c6a48b14ed2a86f7481d8806c11461da1f8ee316b6a40c8229aac240b738ef103242f35d932553cc7de493dc11665e62eb48cc8b0e8d8d7071721d75324709d0",
        "ssdeep": "24576:P7lmNIFktx+pxpvhKM9GIMZQWRwO3MADNlSsy:z5xpvYXIVaMClSsy",
        "created": "2023-03-21T14:30:42Z",
        "completed": "2023-03-21T14:33:19Z"
    },
    "tasks": [
        {
            "sample": "230321-rvg93ada41",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": [
                "family:amadey",
                "family:pseudomanuscrypt",
                "loader",
                "spyware",
                "stealer",
                "trojan"
            ],
            "score": 10,
            "target": "033bbc64f889777be17fa5bc28439d1ee79c94a611a58853790eb865c7d87d54.exe",
            "backend": "sbx4m19",
            "resource": "win7-20230220-en",
            "pick": "static1/unpack001/033bbc64f889777be17fa5bc28439d1ee79c94a611a58853790eb865c7d87d54.exe",
            "os": "windows7-x64",
            "timeout": 150,
            "sigs": 23
        },
        {
            "sample": "230321-rvg93ada41",
            "kind": "behavioral",
            "name": "behavioral2",
            "status": "reported",
            "tags": [
                "family:amadey",
                "spyware",
                "stealer",
                "trojan"
            ],
            "score": 10,
            "target": "033bbc64f889777be17fa5bc28439d1ee79c94a611a58853790eb865c7d87d54.exe",
            "backend": "sbx4m12",
            "resource": "win10v2004-20230220-en",
            "pick": "static1/unpack001/033bbc64f889777be17fa5bc28439d1ee79c94a611a58853790eb865c7d87d54.exe",
            "os": "windows10-2004-x64",
            "timeout": 150,
            "sigs": 14
        },
        {
            "sample": "230321-rvg93ada41",
            "kind": "static",
            "name": "static1",
            "status": "reported",
            "score": 1
        }
    ],
    "analysis": {
        "score": 10,
        "family": [
            "amadey",
            "pseudomanuscrypt"
        ],
        "tags": [
            "family:amadey",
            "family:pseudomanuscrypt",
            "loader",
            "spyware",
            "stealer",
            "trojan"
        ]
    },
    "targets": [
        {
            "tasks": [
                "behavioral1",
                "behavioral2"
            ],
            "score": 10,
            "target": "033bbc64f889777be17fa5bc28439d1ee79c94a611a58853790eb865c7d87d54.exe",
            "pick": "unpack001/033bbc64f889777be17fa5bc28439d1ee79c94a611a58853790eb865c7d87d54.exe",
            "size": 1519104,
            "md5": "056d809fc0b3e0af97316dbfbba1481e",
            "sha1": "9083da544ba4653ca83df9dc04968e0d084f7cfb",
            "sha256": "033bbc64f889777be17fa5bc28439d1ee79c94a611a58853790eb865c7d87d54",
            "sha512": "a9e1a5aeea7959e819c34a90673b1086b1c61ac2fa3279798b56991885b203530398aba290e8b2e2eb3f6967b337b24e18c25b085e4fdd4236ef663fdcb21545",
            "ssdeep": "24576:j3Bdco8g+Jw+uIWdSNmppQIAni/mqjGYqXGkICzZ+apKOiz4GvaG/9jhNpNbWOAD:fxpxIGJppQIAni/mqjGYqXGbuZ+apKO/",
            "tags": [
                "family:amadey",
                "family:pseudomanuscrypt",
                "loader",
                "spyware",
                "stealer",
                "trojan"
            ],
            "family": [
                "amadey",
                "pseudomanuscrypt"
            ],
            "signatures": [
                {
                    "label": "amadey",
                    "name": "Amadey",
                    "score": 10,
                    "tags": [
                        "trojan",
                        "family:amadey"
                    ],
                    "desc": "Amadey bot is a simple trojan bot primarily used for collecting reconnaissance information."
                },
                {
                    "name": "Detects PseudoManuscrypt payload",
                    "score": 10,
                    "tags": [
                        "loader"
                    ],
                    "indicators": [
                        {
                            "resource": "behavioral1/memory/848-104-0x0000000001050000-0x00000000010C2000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1784-110-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1784-113-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1784-114-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/848-116-0x0000000001050000-0x00000000010C2000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1784-120-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1784-121-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1784-123-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1784-124-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1784-163-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1784-165-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1784-166-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        }
                    ]
                },
                {
                    "name": "Process spawned unexpected child process",
                    "score": 10,
                    "desc": "This typically indicates the parent process was compromised via an exploit or macro."
                },
                {
                    "label": "pseudomanuscrypt",
                    "name": "PseudoManuscrypt",
                    "score": 10,
                    "tags": [
                        "loader",
                        "family:pseudomanuscrypt"
                    ],
                    "desc": "PseudoManuscrypt is a malware Lazarus\u2019s Manuscrypt targeting government organizations and ICS."
                },
                {
                    "name": "Suspicious use of NtCreateUserProcessOtherParentProcess",
                    "score": 10
                },
                {
                    "label": "download_pe",
                    "name": "Downloads MZ/PE file",
                    "score": 8
                },
                {
                    "label": "reg_checks_country_code",
                    "name": "Checks computer location settings",
                    "score": 7,
                    "ttp": [
                        "T1012",
                        "T1082"
                    ],
                    "desc": "Looks up country code configured in the registry, likely geofence."
                },
                {
                    "name": "Executes dropped EXE",
                    "score": 7
                },
                {
                    "name": "Loads dropped DLL",
                    "score": 7
                },
                {
                    "label": "browser_user_data_harvesting",
                    "name": "Reads user/profile data of web browsers",
                    "score": 7,
                    "ttp": [
                        "T1005",
                        "T1081"
                    ],
                    "tags": [
                        "spyware",
                        "stealer"
                    ],
                    "desc": "Infostealers often target stored browser data, which can include saved credentials etc."
                },
                {
                    "label": "unexpected_dns",
                    "name": "Unexpected DNS network traffic destination",
                    "score": 7,
                    "desc": "Network traffic to other servers than the configured DNS servers was detected on the DNS port."
                },
                {
                    "name": "Suspicious use of SetThreadContext",
                    "score": 5
                },
                {
                    "label": "fw_windows",
                    "name": "Drops file in Windows directory",
                    "score": 4
                },
                {
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": [
                        "T1082"
                    ],
                    "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour."
                },
                {
                    "label": "program_crash",
                    "name": "Program crash",
                    "score": 3
                },
                {
                    "label": "reg_hw_processor",
                    "name": "Checks processor information in registry",
                    "ttp": [
                        "T1012",
                        "T1082"
                    ],
                    "desc": "Processor information is often read in order to detect sandboxing environments."
                },
                {
                    "label": "schtasks_persist",
                    "name": "Creates scheduled task(s)",
                    "ttp": [
                        "T1053"
                    ],
                    "tags": [
                        "persistence"
                    ],
                    "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution."
                },
                {
                    "label": "reg_hku_write",
                    "name": "Modifies data under HKEY_USERS"
                },
                {
                    "label": "reg_software_classes",
                    "name": "Modifies registry class"
                },
                {
                    "label": "uses_scripting_ua",
                    "name": "Script User-Agent",
                    "desc": "Uses user-agent string associated with script host/environment."
                },
                {
                    "name": "Suspicious behavior: EnumeratesProcesses"
                },
                {
                    "name": "Suspicious use of AdjustPrivilegeToken"
                },
                {
                    "name": "Suspicious use of SetWindowsHookEx"
                },
                {
                    "name": "Suspicious use of WriteProcessMemory"
                }
            ],
            "iocs": {
                "urls": [
                    "https://j.ffbbjjkk.com/2701.html",
                    "https://j.ffbbjjkk.com/logo.png",
                    "http://77.73.134.27/8bmdh3Slb2/index.php?scr=1",
                    "http://77.73.134.27/8bmdh3Slb2/index.php",
                    "http://77.73.134.27/8bmdh3Slb2/Plugins/cred64.dll",
                    "http://77.73.134.27/8bmdh3Slb2/Plugins/clip64.dll",
                    "http://bz.bbbeioaag.com/sts/bimage.jpg",
                    "https://www.facebook.com/ads/manager/account_settings/account_billing",
                    "https://www.facebook.com/login.php?next=https%3A%2F%2Fwww.facebook.com%2Fads%2Fmanager%2Faccount_settings%2Faccount_billing",
                    "http://count.iiagjaggg.com/check/safe",
                    "http://count.iiagjaggg.com/check/?sid=1037771&key=696b22ad91c4878e060fe8d37ea0212f",
                    "http://count.iiagjaggg.com/check/?sid=1037905&key=0d2ee3a232d851905c7a278ab140ff2d"
                ],
                "domains": [
                    "j.ffbbjjkk.com",
                    "y1.ffbbyykk.com",
                    "rpraqmrigh.com",
                    "peaqqrjofi.com",
                    "209.205.72.20.in-addr.arpa",
                    "bz.bbbeioaag.com",
                    "227.8.21.104.in-addr.arpa",
                    "131.17.126.40.in-addr.arpa",
                    "27.134.73.77.in-addr.arpa",
                    "210.81.184.52.in-addr.arpa",
                    "232.168.11.51.in-addr.arpa",
                    "107.113.136.45.in-addr.arpa",
                    "www.facebook.com",
                    "count.iiagjaggg.com",
                    "179.159.66.45.in-addr.arpa",
                    "35.221.240.157.in-addr.arpa",
                    "55.154.139.52.in-addr.arpa",
                    "151.122.125.40.in-addr.arpa",
                    "2.36.159.162.in-addr.arpa",
                    "202.74.101.95.in-addr.arpa",
                    "254.137.241.8.in-addr.arpa"
                ],
                "ips": [
                    "8.8.8.8",
                    "172.67.158.22",
                    "77.73.134.27",
                    "34.142.181.181",
                    "34.70.8.56",
                    "34.69.9.82",
                    "93.184.221.240",
                    "45.136.113.107",
                    "104.21.8.227",
                    "52.152.108.96",
                    "157.240.221.35",
                    "45.66.159.179",
                    "20.189.173.3",
                    "93.184.220.29",
                    "173.223.113.164",
                    "173.223.113.131",
                    "204.79.197.203"
                ]
            }
        }
    ],
    "signatures": [
        {
            "label": "amadey",
            "name": "Amadey",
            "score": 10,
            "tags": [
                "trojan",
                "family:amadey"
            ],
            "desc": "Amadey bot is a simple trojan bot primarily used for collecting reconnaissance information."
        },
        {
            "name": "Detects PseudoManuscrypt payload",
            "score": 10,
            "tags": [
                "loader"
            ],
            "indicators": [
                {
                    "resource": "behavioral1/memory/848-104-0x0000000001050000-0x00000000010C2000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1784-110-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1784-113-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1784-114-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/848-116-0x0000000001050000-0x00000000010C2000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1784-120-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1784-121-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1784-123-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1784-124-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1784-163-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1784-165-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1784-166-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                }
            ]
        },
        {
            "name": "Process spawned unexpected child process",
            "score": 10,
            "desc": "This typically indicates the parent process was compromised via an exploit or macro."
        },
        {
            "label": "pseudomanuscrypt",
            "name": "PseudoManuscrypt",
            "score": 10,
            "tags": [
                "loader",
                "family:pseudomanuscrypt"
            ],
            "desc": "PseudoManuscrypt is a malware Lazarus\u2019s Manuscrypt targeting government organizations and ICS."
        },
        {
            "name": "Suspicious use of NtCreateUserProcessOtherParentProcess",
            "score": 10
        },
        {
            "label": "download_pe",
            "name": "Downloads MZ/PE file",
            "score": 8
        },
        {
            "label": "reg_checks_country_code",
            "name": "Checks computer location settings",
            "score": 7,
            "ttp": [
                "T1012",
                "T1082"
            ],
            "desc": "Looks up country code configured in the registry, likely geofence."
        },
        {
            "name": "Executes dropped EXE",
            "score": 7
        },
        {
            "name": "Loads dropped DLL",
            "score": 7
        },
        {
            "label": "browser_user_data_harvesting",
            "name": "Reads user/profile data of web browsers",
            "score": 7,
            "ttp": [
                "T1005",
                "T1081"
            ],
            "tags": [
                "spyware",
                "stealer"
            ],
            "desc": "Infostealers often target stored browser data, which can include saved credentials etc."
        },
        {
            "label": "unexpected_dns",
            "name": "Unexpected DNS network traffic destination",
            "score": 7,
            "desc": "Network traffic to other servers than the configured DNS servers was detected on the DNS port."
        },
        {
            "name": "Suspicious use of SetThreadContext",
            "score": 5
        },
        {
            "label": "fw_windows",
            "name": "Drops file in Windows directory",
            "score": 4
        },
        {
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": [
                "T1082"
            ],
            "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour."
        },
        {
            "label": "program_crash",
            "name": "Program crash",
            "score": 3
        },
        {
            "label": "reg_hw_processor",
            "name": "Checks processor information in registry",
            "ttp": [
                "T1012",
                "T1082"
            ],
            "desc": "Processor information is often read in order to detect sandboxing environments."
        },
        {
            "label": "schtasks_persist",
            "name": "Creates scheduled task(s)",
            "ttp": [
                "T1053"
            ],
            "tags": [
                "persistence"
            ],
            "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution."
        },
        {
            "label": "reg_hku_write",
            "name": "Modifies data under HKEY_USERS"
        },
        {
            "label": "reg_software_classes",
            "name": "Modifies registry class"
        },
        {
            "label": "uses_scripting_ua",
            "name": "Script User-Agent",
            "desc": "Uses user-agent string associated with script host/environment."
        },
        {
            "name": "Suspicious behavior: EnumeratesProcesses"
        },
        {
            "name": "Suspicious use of AdjustPrivilegeToken"
        },
        {
            "name": "Suspicious use of SetWindowsHookEx"
        },
        {
            "name": "Suspicious use of WriteProcessMemory"
        }
    ],
    "extracted": [
        {
            "tasks": [
                "behavioral1",
                "behavioral2"
            ],
            "dumped_file": "files/0x000a00000001272d-57.dat",
            "resource": "behavioral1/files/0x000a00000001272d-57.dat",
            "config": {
                "family": "amadey",
                "rule": "AmadeyV2",
                "c2": [
                    "77.73.134.27/8bmdh3Slb2/index.php"
                ],
                "version": "3.65"
            }
        }
    ]
}