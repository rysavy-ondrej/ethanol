{
    "version": "0.2.3",
    "sample": {
        "id": "230321-rvjswsah82",
        "score": 10,
        "target": "e8f0e3fe795f96909d2ce54434a20f0c87a8bde815e790a7de9fd48b7eb11969.zip",
        "size": 1074709,
        "md5": "61740c5cf10af9d2c3f6645910633147",
        "sha1": "7e16bb3b780fc1b0dd072f0bd0e0792f2634a84c",
        "sha256": "39f3763e35309aa55b43612ffc3113bb5d0cc7de2383dd5184a646420a47e889",
        "sha512": "b941463e6e7f1feefe8ee56c8949ae66108cf23516bd748fb62fcd4e0d4c4368d7cf22ddd2bb56a75e30664f7e6b0b0037229582354cb66a3abbd4f15fb3efb6",
        "ssdeep": "24576:GOMcvem3u/X4hq4U6jkhIxPUk+NvAfjPrPU27nshkzY7C:GDcvy/XoBohIxwNvGjPrPH7ng17C",
        "created": "2023-03-21T14:30:47Z",
        "completed": "2023-03-21T14:33:25Z"
    },
    "tasks": [
        {
            "sample": "230321-rvjswsah82",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": [
                "family:amadey",
                "family:pseudomanuscrypt",
                "loader",
                "spyware",
                "stealer",
                "trojan"
            ],
            "score": 10,
            "target": "e8f0e3fe795f96909d2ce54434a20f0c87a8bde815e790a7de9fd48b7eb11969.exe",
            "backend": "sbx4m16",
            "resource": "win7-20230220-en",
            "pick": "static1/unpack001/e8f0e3fe795f96909d2ce54434a20f0c87a8bde815e790a7de9fd48b7eb11969.exe",
            "os": "windows7-x64",
            "timeout": 150,
            "sigs": 23
        },
        {
            "sample": "230321-rvjswsah82",
            "kind": "behavioral",
            "name": "behavioral2",
            "status": "reported",
            "tags": [
                "family:amadey",
                "spyware",
                "stealer",
                "trojan"
            ],
            "score": 10,
            "target": "e8f0e3fe795f96909d2ce54434a20f0c87a8bde815e790a7de9fd48b7eb11969.exe",
            "backend": "sbx4m19",
            "resource": "win10v2004-20230220-en",
            "pick": "static1/unpack001/e8f0e3fe795f96909d2ce54434a20f0c87a8bde815e790a7de9fd48b7eb11969.exe",
            "os": "windows10-2004-x64",
            "timeout": 150,
            "sigs": 14
        },
        {
            "sample": "230321-rvjswsah82",
            "kind": "static",
            "name": "static1",
            "status": "reported",
            "score": 1
        }
    ],
    "analysis": {
        "score": 10,
        "family": [
            "amadey",
            "pseudomanuscrypt"
        ],
        "tags": [
            "family:amadey",
            "family:pseudomanuscrypt",
            "loader",
            "spyware",
            "stealer",
            "trojan"
        ]
    },
    "targets": [
        {
            "tasks": [
                "behavioral1",
                "behavioral2"
            ],
            "score": 10,
            "target": "e8f0e3fe795f96909d2ce54434a20f0c87a8bde815e790a7de9fd48b7eb11969.exe",
            "pick": "unpack001/e8f0e3fe795f96909d2ce54434a20f0c87a8bde815e790a7de9fd48b7eb11969.exe",
            "size": 1519104,
            "md5": "0de84a66b983d2f407390473dd1e37de",
            "sha1": "21de93ab0f4e6706403e0bd3167be9aa8178018b",
            "sha256": "e8f0e3fe795f96909d2ce54434a20f0c87a8bde815e790a7de9fd48b7eb11969",
            "sha512": "37fc3f31dbb2721565c56974638e483cf3700779b4bbe324c26dbf4f45721211516b041b519b63bd8feb653b8b1de6bda8c52736085f72ff597d5fcb8d839a94",
            "ssdeep": "24576:m3Bdco8g+Jw+uIWdSNmppQIAni/mqjGYqXGkICzZ+apKOiz4GvaG/9jhNpNbWOAD:sxpxIGJppQIAni/mqjGYqXGbuZ+apKO/",
            "tags": [
                "family:amadey",
                "family:pseudomanuscrypt",
                "loader",
                "spyware",
                "stealer",
                "trojan"
            ],
            "family": [
                "amadey",
                "pseudomanuscrypt"
            ],
            "signatures": [
                {
                    "label": "amadey",
                    "name": "Amadey",
                    "score": 10,
                    "tags": [
                        "trojan",
                        "family:amadey"
                    ],
                    "desc": "Amadey bot is a simple trojan bot primarily used for collecting reconnaissance information."
                },
                {
                    "name": "Detects PseudoManuscrypt payload",
                    "score": 10,
                    "tags": [
                        "loader"
                    ],
                    "indicators": [
                        {
                            "resource": "behavioral1/memory/860-105-0x0000000001E20000-0x0000000001E92000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1636-110-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1636-113-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1636-114-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/860-116-0x0000000001E20000-0x0000000001E92000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1636-119-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1636-121-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1636-123-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1636-124-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1636-163-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1636-165-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        },
                        {
                            "resource": "behavioral1/memory/1636-166-0x0000000000490000-0x0000000000502000-memory.dmp",
                            "yara_rule": "family_pseudomanuscrypt"
                        }
                    ]
                },
                {
                    "name": "Process spawned unexpected child process",
                    "score": 10,
                    "desc": "This typically indicates the parent process was compromised via an exploit or macro."
                },
                {
                    "label": "pseudomanuscrypt",
                    "name": "PseudoManuscrypt",
                    "score": 10,
                    "tags": [
                        "loader",
                        "family:pseudomanuscrypt"
                    ],
                    "desc": "PseudoManuscrypt is a malware Lazarus\u2019s Manuscrypt targeting government organizations and ICS."
                },
                {
                    "name": "Suspicious use of NtCreateUserProcessOtherParentProcess",
                    "score": 10
                },
                {
                    "label": "download_pe",
                    "name": "Downloads MZ/PE file",
                    "score": 8
                },
                {
                    "label": "reg_checks_country_code",
                    "name": "Checks computer location settings",
                    "score": 7,
                    "ttp": [
                        "T1012",
                        "T1082"
                    ],
                    "desc": "Looks up country code configured in the registry, likely geofence."
                },
                {
                    "name": "Executes dropped EXE",
                    "score": 7
                },
                {
                    "name": "Loads dropped DLL",
                    "score": 7
                },
                {
                    "label": "browser_user_data_harvesting",
                    "name": "Reads user/profile data of web browsers",
                    "score": 7,
                    "ttp": [
                        "T1005",
                        "T1081"
                    ],
                    "tags": [
                        "spyware",
                        "stealer"
                    ],
                    "desc": "Infostealers often target stored browser data, which can include saved credentials etc."
                },
                {
                    "label": "unexpected_dns",
                    "name": "Unexpected DNS network traffic destination",
                    "score": 7,
                    "desc": "Network traffic to other servers than the configured DNS servers was detected on the DNS port."
                },
                {
                    "name": "Suspicious use of SetThreadContext",
                    "score": 5
                },
                {
                    "label": "fw_windows",
                    "name": "Drops file in Windows directory",
                    "score": 4
                },
                {
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": [
                        "T1082"
                    ],
                    "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour."
                },
                {
                    "label": "program_crash",
                    "name": "Program crash",
                    "score": 3
                },
                {
                    "label": "reg_hw_processor",
                    "name": "Checks processor information in registry",
                    "ttp": [
                        "T1012",
                        "T1082"
                    ],
                    "desc": "Processor information is often read in order to detect sandboxing environments."
                },
                {
                    "label": "schtasks_persist",
                    "name": "Creates scheduled task(s)",
                    "ttp": [
                        "T1053"
                    ],
                    "tags": [
                        "persistence"
                    ],
                    "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution."
                },
                {
                    "label": "reg_hku_write",
                    "name": "Modifies data under HKEY_USERS"
                },
                {
                    "label": "reg_software_classes",
                    "name": "Modifies registry class"
                },
                {
                    "label": "uses_scripting_ua",
                    "name": "Script User-Agent",
                    "desc": "Uses user-agent string associated with script host/environment."
                },
                {
                    "name": "Suspicious behavior: EnumeratesProcesses"
                },
                {
                    "name": "Suspicious use of AdjustPrivilegeToken"
                },
                {
                    "name": "Suspicious use of SetWindowsHookEx"
                },
                {
                    "name": "Suspicious use of WriteProcessMemory"
                }
            ],
            "iocs": {
                "urls": [
                    "https://j.ffbbjjkk.com/2701.html",
                    "https://j.ffbbjjkk.com/logo.png",
                    "http://77.73.134.27/8bmdh3Slb2/index.php?scr=1",
                    "http://77.73.134.27/8bmdh3Slb2/index.php",
                    "http://77.73.134.27/8bmdh3Slb2/Plugins/cred64.dll",
                    "http://77.73.134.27/8bmdh3Slb2/Plugins/clip64.dll",
                    "http://bz.bbbeioaag.com/sts/bimage.jpg",
                    "https://www.facebook.com/ads/manager/account_settings/account_billing",
                    "https://www.facebook.com/login.php?next=https%3A%2F%2Fwww.facebook.com%2Fads%2Fmanager%2Faccount_settings%2Faccount_billing",
                    "http://count.iiagjaggg.com/check/safe",
                    "http://count.iiagjaggg.com/check/?sid=1037545&key=281d42fb99e5f0a4bda3128965a8d9d0",
                    "http://count.iiagjaggg.com/check/?sid=1037635&key=b4687c15a829b62451489ed7c199cd2a"
                ],
                "domains": [
                    "j.ffbbjjkk.com",
                    "y1.ffbbyykk.com",
                    "rpraqmrigh.com",
                    "peaqqrjofi.com",
                    "164.2.77.40.in-addr.arpa",
                    "196.249.167.52.in-addr.arpa",
                    "bz.bbbeioaag.com",
                    "107.113.136.45.in-addr.arpa",
                    "22.158.67.172.in-addr.arpa",
                    "33.18.126.40.in-addr.arpa",
                    "27.134.73.77.in-addr.arpa",
                    "216.74.101.95.in-addr.arpa",
                    "www.facebook.com",
                    "35.5.240.157.in-addr.arpa",
                    "count.iiagjaggg.com",
                    "179.159.66.45.in-addr.arpa",
                    "209.205.72.20.in-addr.arpa",
                    "176.122.125.40.in-addr.arpa",
                    "2.36.159.162.in-addr.arpa",
                    "226.101.242.52.in-addr.arpa",
                    "136.32.126.40.in-addr.arpa",
                    "28.143.109.104.in-addr.arpa",
                    "143.145.190.20.in-addr.arpa",
                    "56.126.166.20.in-addr.arpa",
                    "103.169.127.40.in-addr.arpa",
                    "58.104.205.20.in-addr.arpa",
                    "76.38.195.152.in-addr.arpa",
                    "86.8.109.52.in-addr.arpa"
                ],
                "ips": [
                    "8.8.8.8",
                    "172.67.158.22",
                    "77.73.134.27",
                    "34.142.181.181",
                    "34.70.8.56",
                    "34.170.125.67",
                    "40.77.2.164",
                    "52.152.110.14",
                    "45.136.113.107",
                    "157.240.5.35",
                    "45.66.159.179",
                    "20.253.213.245",
                    "117.18.232.240",
                    "173.223.113.164",
                    "173.223.113.131",
                    "131.253.33.203"
                ]
            }
        }
    ],
    "signatures": [
        {
            "label": "amadey",
            "name": "Amadey",
            "score": 10,
            "tags": [
                "trojan",
                "family:amadey"
            ],
            "desc": "Amadey bot is a simple trojan bot primarily used for collecting reconnaissance information."
        },
        {
            "name": "Detects PseudoManuscrypt payload",
            "score": 10,
            "tags": [
                "loader"
            ],
            "indicators": [
                {
                    "resource": "behavioral1/memory/860-105-0x0000000001E20000-0x0000000001E92000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1636-110-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1636-113-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1636-114-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/860-116-0x0000000001E20000-0x0000000001E92000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1636-119-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1636-121-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1636-123-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1636-124-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1636-163-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1636-165-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                },
                {
                    "resource": "behavioral1/memory/1636-166-0x0000000000490000-0x0000000000502000-memory.dmp",
                    "yara_rule": "family_pseudomanuscrypt"
                }
            ]
        },
        {
            "name": "Process spawned unexpected child process",
            "score": 10,
            "desc": "This typically indicates the parent process was compromised via an exploit or macro."
        },
        {
            "label": "pseudomanuscrypt",
            "name": "PseudoManuscrypt",
            "score": 10,
            "tags": [
                "loader",
                "family:pseudomanuscrypt"
            ],
            "desc": "PseudoManuscrypt is a malware Lazarus\u2019s Manuscrypt targeting government organizations and ICS."
        },
        {
            "name": "Suspicious use of NtCreateUserProcessOtherParentProcess",
            "score": 10
        },
        {
            "label": "download_pe",
            "name": "Downloads MZ/PE file",
            "score": 8
        },
        {
            "label": "reg_checks_country_code",
            "name": "Checks computer location settings",
            "score": 7,
            "ttp": [
                "T1012",
                "T1082"
            ],
            "desc": "Looks up country code configured in the registry, likely geofence."
        },
        {
            "name": "Executes dropped EXE",
            "score": 7
        },
        {
            "name": "Loads dropped DLL",
            "score": 7
        },
        {
            "label": "browser_user_data_harvesting",
            "name": "Reads user/profile data of web browsers",
            "score": 7,
            "ttp": [
                "T1005",
                "T1081"
            ],
            "tags": [
                "spyware",
                "stealer"
            ],
            "desc": "Infostealers often target stored browser data, which can include saved credentials etc."
        },
        {
            "label": "unexpected_dns",
            "name": "Unexpected DNS network traffic destination",
            "score": 7,
            "desc": "Network traffic to other servers than the configured DNS servers was detected on the DNS port."
        },
        {
            "name": "Suspicious use of SetThreadContext",
            "score": 5
        },
        {
            "label": "fw_windows",
            "name": "Drops file in Windows directory",
            "score": 4
        },
        {
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": [
                "T1082"
            ],
            "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour."
        },
        {
            "label": "program_crash",
            "name": "Program crash",
            "score": 3
        },
        {
            "label": "reg_hw_processor",
            "name": "Checks processor information in registry",
            "ttp": [
                "T1012",
                "T1082"
            ],
            "desc": "Processor information is often read in order to detect sandboxing environments."
        },
        {
            "label": "schtasks_persist",
            "name": "Creates scheduled task(s)",
            "ttp": [
                "T1053"
            ],
            "tags": [
                "persistence"
            ],
            "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution."
        },
        {
            "label": "reg_hku_write",
            "name": "Modifies data under HKEY_USERS"
        },
        {
            "label": "reg_software_classes",
            "name": "Modifies registry class"
        },
        {
            "label": "uses_scripting_ua",
            "name": "Script User-Agent",
            "desc": "Uses user-agent string associated with script host/environment."
        },
        {
            "name": "Suspicious behavior: EnumeratesProcesses"
        },
        {
            "name": "Suspicious use of AdjustPrivilegeToken"
        },
        {
            "name": "Suspicious use of SetWindowsHookEx"
        },
        {
            "name": "Suspicious use of WriteProcessMemory"
        }
    ],
    "extracted": [
        {
            "tasks": [
                "behavioral1",
                "behavioral2"
            ],
            "dumped_file": "files/0x001500000000b524-57.dat",
            "resource": "behavioral1/files/0x001500000000b524-57.dat",
            "config": {
                "family": "amadey",
                "rule": "AmadeyV2",
                "c2": [
                    "77.73.134.27/8bmdh3Slb2/index.php"
                ],
                "version": "3.65"
            }
        }
    ]
}