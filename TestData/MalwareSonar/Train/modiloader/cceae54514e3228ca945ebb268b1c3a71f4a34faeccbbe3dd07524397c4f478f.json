{
    "version": "0.2.3",
    "sample": {
        "id": "230321-qn89jaad96",
        "score": 10,
        "target": "cceae54514e3228ca945ebb268b1c3a71f4a34faeccbbe3dd07524397c4f478f.zip",
        "size": 339953,
        "md5": "343d29ac28c8daa89d97264684ce1586",
        "sha1": "77d8219267d0f18cc21f92817d2e1bc06e32b410",
        "sha256": "d9b6549b3b93318118feeaf1a3ce2704c147ad066c7a02dbd8875d68ceae2b9b",
        "sha512": "109a2a3efab9c2aed8f6415def2a4a212d75d7b5f903ac4f3391af14aab4bd75a640b690c8dd50077f1bb56fa83e74cdb04420318698ac48e7a84253f2896eb5",
        "ssdeep": "6144:WwNRYMIzl++h/oGry4Osd8AerWOXsZybHcXuGgrHoQ84YGHWQuKev:WwNkBpVR90rHXEyzWsT88HSKev",
        "created": "2023-03-21T13:25:36Z",
        "completed": "2023-03-21T13:28:16Z"
    },
    "tasks": [
        {
            "sample": "230321-qn89jaad96",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": [
                "family:modiloader",
                "trojan"
            ],
            "score": 10,
            "target": "cceae54514e3228ca945ebb268b1c3a71f4a34faeccbbe3dd07524397c4f478f.exe",
            "backend": "fu1m1",
            "resource": "win7-20230220-en",
            "pick": "static1/unpack001/cceae54514e3228ca945ebb268b1c3a71f4a34faeccbbe3dd07524397c4f478f.exe",
            "os": "windows7-x64",
            "timeout": 150,
            "sigs": 2
        },
        {
            "sample": "230321-qn89jaad96",
            "kind": "behavioral",
            "name": "behavioral2",
            "status": "reported",
            "tags": [
                "family:modiloader",
                "persistence",
                "trojan"
            ],
            "score": 10,
            "target": "cceae54514e3228ca945ebb268b1c3a71f4a34faeccbbe3dd07524397c4f478f.exe",
            "backend": "sbx4m16",
            "resource": "win10v2004-20230221-en",
            "pick": "static1/unpack001/cceae54514e3228ca945ebb268b1c3a71f4a34faeccbbe3dd07524397c4f478f.exe",
            "os": "windows10-2004-x64",
            "timeout": 150,
            "sigs": 11
        },
        {
            "sample": "230321-qn89jaad96",
            "kind": "static",
            "name": "static1",
            "status": "reported",
            "score": 1
        }
    ],
    "analysis": {
        "score": 10,
        "family": [
            "modiloader"
        ],
        "tags": [
            "family:modiloader",
            "persistence",
            "trojan"
        ]
    },
    "targets": [
        {
            "tasks": [
                "behavioral1",
                "behavioral2"
            ],
            "score": 10,
            "target": "cceae54514e3228ca945ebb268b1c3a71f4a34faeccbbe3dd07524397c4f478f.exe",
            "pick": "unpack001/cceae54514e3228ca945ebb268b1c3a71f4a34faeccbbe3dd07524397c4f478f.exe",
            "size": 789504,
            "md5": "406d72b38cb0340752ff14290ec2e9e8",
            "sha1": "809309bb3d86eb78cc7a2a21586bc0b379f5e838",
            "sha256": "cceae54514e3228ca945ebb268b1c3a71f4a34faeccbbe3dd07524397c4f478f",
            "sha512": "871767e3f39dda0a073c406cf712866158d709e8fd8b3535367466a4bda7d5993f9b7d815d83c75a26b72421298c31784fb00cb4ea85324e213ba11ec2207251",
            "ssdeep": "12288:Pr5Nxzs78p/cJCzQkgtr80XGjObPkOOfIiteSmF0Z/:PFvzs7bJWbgtopibPkOOnm0",
            "tags": [
                "family:modiloader",
                "trojan",
                "persistence"
            ],
            "family": [
                "modiloader"
            ],
            "signatures": [
                {
                    "label": "modiloader",
                    "name": "ModiLoader, DBatLoader",
                    "score": 10,
                    "tags": [
                        "trojan",
                        "family:modiloader"
                    ],
                    "desc": "ModiLoader is a Delphi loader that misuses cloud services to download other malicious families."
                },
                {
                    "name": "ModiLoader Second Stage",
                    "score": 9,
                    "indicators": [
                        {
                            "resource": "behavioral1/memory/968-54-0x00000000002C0000-0x00000000002EC000-memory.dmp",
                            "yara_rule": "modiloader_stage2"
                        },
                        {
                            "resource": "behavioral2/memory/392-134-0x0000000004110000-0x000000000413C000-memory.dmp",
                            "yara_rule": "modiloader_stage2"
                        }
                    ]
                },
                {
                    "name": "Executes dropped EXE",
                    "score": 7
                },
                {
                    "name": "Loads dropped DLL",
                    "score": 7
                },
                {
                    "label": "creates_runkey_registry",
                    "name": "Adds Run key to start application",
                    "score": 6,
                    "ttp": [
                        "T1060",
                        "T1112"
                    ],
                    "tags": [
                        "persistence"
                    ]
                },
                {
                    "label": "program_crash",
                    "name": "Program crash",
                    "score": 3
                },
                {
                    "label": "reg_hw_system",
                    "name": "Enumerates system info in registry",
                    "ttp": [
                        "T1012",
                        "T1082"
                    ]
                },
                {
                    "label": "ping_generic",
                    "name": "Runs ping.exe",
                    "ttp": [
                        "T1018"
                    ]
                },
                {
                    "name": "Suspicious behavior: EnumeratesProcesses"
                },
                {
                    "name": "Suspicious use of AdjustPrivilegeToken"
                },
                {
                    "name": "Suspicious use of WriteProcessMemory"
                }
            ],
            "iocs": {
                "urls": [
                    "http://www.microsoft.com/pkiops/crl/Microsoft%20Azure%20TLS%20Issuing%20CA%2005.crl",
                    "https://onedrive.live.com/download?cid=1FB7F0D506202A2E&resid=1FB7F0D506202A2E%21163&authkey=AF-kKb9IcOOtAwQ",
                    "https://6vyriq.dm.files.1drv.com/y4mB3FFY8a8ryPmrzczXloeyED0fdM1ZdnCzsd0jNzBir_VWqRzPZmN3G3iz8naeGb1z8xnbPT77_oASuiISESCAQY5NZKZIdCUZOaycB19OBvefWKCzSe4oqcB7HMUrLl4sofBUTPYxD6VYETY31vgTStCG3csSFB913pauNwRBTlaNSySr2jF6YeGDEMPUXEpDVA5N-ts6v3MG9-D8oaP2A/Vabiukbpuxd?download&psid=1"
                ],
                "domains": [
                    "onedrive.live.com",
                    "176.122.125.40.in-addr.arpa",
                    "228.249.119.40.in-addr.arpa",
                    "76.32.126.40.in-addr.arpa",
                    "58.104.205.20.in-addr.arpa",
                    "149.220.183.52.in-addr.arpa",
                    "97.97.242.52.in-addr.arpa",
                    "2.36.159.162.in-addr.arpa",
                    "13.42.107.13.in-addr.arpa",
                    "97.17.167.52.in-addr.arpa",
                    "6vyriq.dm.files.1drv.com",
                    "12.43.107.13.in-addr.arpa",
                    "103.169.127.40.in-addr.arpa",
                    "226.101.242.52.in-addr.arpa",
                    "121.175.53.84.in-addr.arpa",
                    "45.8.109.52.in-addr.arpa",
                    "210.81.184.52.in-addr.arpa",
                    "76.38.195.152.in-addr.arpa",
                    "216.74.101.95.in-addr.arpa"
                ],
                "ips": [
                    "8.8.8.8",
                    "13.107.42.13",
                    "173.223.113.131",
                    "20.234.34.18",
                    "20.40.136.238",
                    "13.107.43.12",
                    "52.182.143.210",
                    "117.18.237.29",
                    "209.197.3.8"
                ]
            }
        }
    ],
    "signatures": [
        {
            "label": "modiloader",
            "name": "ModiLoader, DBatLoader",
            "score": 10,
            "tags": [
                "trojan",
                "family:modiloader"
            ],
            "desc": "ModiLoader is a Delphi loader that misuses cloud services to download other malicious families."
        },
        {
            "name": "ModiLoader Second Stage",
            "score": 9,
            "indicators": [
                {
                    "resource": "behavioral1/memory/968-54-0x00000000002C0000-0x00000000002EC000-memory.dmp",
                    "yara_rule": "modiloader_stage2"
                },
                {
                    "resource": "behavioral2/memory/392-134-0x0000000004110000-0x000000000413C000-memory.dmp",
                    "yara_rule": "modiloader_stage2"
                }
            ]
        },
        {
            "name": "Executes dropped EXE",
            "score": 7
        },
        {
            "name": "Loads dropped DLL",
            "score": 7
        },
        {
            "label": "creates_runkey_registry",
            "name": "Adds Run key to start application",
            "score": 6,
            "ttp": [
                "T1060",
                "T1112"
            ],
            "tags": [
                "persistence"
            ]
        },
        {
            "label": "program_crash",
            "name": "Program crash",
            "score": 3
        },
        {
            "label": "reg_hw_system",
            "name": "Enumerates system info in registry",
            "ttp": [
                "T1012",
                "T1082"
            ]
        },
        {
            "label": "ping_generic",
            "name": "Runs ping.exe",
            "ttp": [
                "T1018"
            ]
        },
        {
            "name": "Suspicious behavior: EnumeratesProcesses"
        },
        {
            "name": "Suspicious use of AdjustPrivilegeToken"
        },
        {
            "name": "Suspicious use of WriteProcessMemory"
        }
    ]
}