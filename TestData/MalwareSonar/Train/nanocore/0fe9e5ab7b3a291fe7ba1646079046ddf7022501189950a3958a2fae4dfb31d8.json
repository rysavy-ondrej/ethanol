{
    "version": "0.2.3",
    "sample": {
        "id": "230321-qn4n2sce4w",
        "score": 10,
        "target": "0fe9e5ab7b3a291fe7ba1646079046ddf7022501189950a3958a2fae4dfb31d8.zip",
        "size": 787081,
        "md5": "77eb2c50c57806530affc12e991cf665",
        "sha1": "1f7199a36da69d5c9994f10dd6674183981d4f91",
        "sha256": "a19a879b5bf239eb99d7a7431650a543dc36f376e8a34a36d56230a6b0b97437",
        "sha512": "01d5bb9e857ee260c6c31ad6473a73e378f6f86b47cbcb5e93193ff6cce50cd7ca3f441db823873e90c3a4817097e84affc6ff4b94c9078b3071df297d5047a5",
        "ssdeep": "12288:HXNsHjzlIGS0c26AUJnTYkJP1iriUtM3wiJryYD7yRSfltwfLOaU/TdD1aCW:HiHlIt2pUpfR1xUtMhe47yCtwzrMZDY",
        "created": "2023-03-21T13:25:21Z",
        "completed": "2023-03-21T13:27:57Z"
    },
    "tasks": [
        {
            "sample": "230321-qn4n2sce4w",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": [
                "family:nanocore",
                "evasion",
                "keylogger",
                "persistence",
                "spyware",
                "stealer",
                "trojan"
            ],
            "score": 10,
            "target": "0fe9e5ab7b3a291fe7ba1646079046ddf7022501189950a3958a2fae4dfb31d8.exe",
            "backend": "sbx4m19",
            "resource": "win7-20230220-en",
            "pick": "static1/unpack001/0fe9e5ab7b3a291fe7ba1646079046ddf7022501189950a3958a2fae4dfb31d8.exe",
            "os": "windows7-x64",
            "timeout": 150,
            "sigs": 12
        },
        {
            "sample": "230321-qn4n2sce4w",
            "kind": "behavioral",
            "name": "behavioral2",
            "status": "reported",
            "tags": [
                "family:nanocore",
                "evasion",
                "keylogger",
                "persistence",
                "spyware",
                "stealer",
                "trojan"
            ],
            "score": 10,
            "target": "0fe9e5ab7b3a291fe7ba1646079046ddf7022501189950a3958a2fae4dfb31d8.exe",
            "backend": "sbx4m12",
            "resource": "win10v2004-20230220-en",
            "pick": "static1/unpack001/0fe9e5ab7b3a291fe7ba1646079046ddf7022501189950a3958a2fae4dfb31d8.exe",
            "os": "windows10-2004-x64",
            "timeout": 150,
            "sigs": 13
        },
        {
            "sample": "230321-qn4n2sce4w",
            "kind": "static",
            "name": "static1",
            "status": "reported",
            "score": 1
        }
    ],
    "analysis": {
        "score": 10,
        "family": [
            "nanocore"
        ],
        "tags": [
            "family:nanocore",
            "evasion",
            "keylogger",
            "persistence",
            "spyware",
            "stealer",
            "trojan"
        ]
    },
    "targets": [
        {
            "tasks": [
                "behavioral1",
                "behavioral2"
            ],
            "score": 10,
            "target": "0fe9e5ab7b3a291fe7ba1646079046ddf7022501189950a3958a2fae4dfb31d8.exe",
            "pick": "unpack001/0fe9e5ab7b3a291fe7ba1646079046ddf7022501189950a3958a2fae4dfb31d8.exe",
            "size": 907776,
            "md5": "97c39ff05e019c1dd9e33567c8e864e1",
            "sha1": "ae3e502949d784bb17b35263cfd22220491862f7",
            "sha256": "0fe9e5ab7b3a291fe7ba1646079046ddf7022501189950a3958a2fae4dfb31d8",
            "sha512": "2541ab7591abc9d2bf732ba4cf1e806ae36f37e4a0ef00b5f3cf29ff51f534a2cf39f529ec4fafdb370cee2ce35414554d2163947240ee89a28dba7cc8b602b7",
            "ssdeep": "24576:BJjkj+TDvEWdrAVqcTAsHxOiwwyWtZ/9/FUMw:BJjkYIxqcTABiwwyWtV9t5w",
            "tags": [
                "family:nanocore",
                "evasion",
                "keylogger",
                "persistence",
                "spyware",
                "stealer",
                "trojan"
            ],
            "family": [
                "nanocore"
            ],
            "signatures": [
                {
                    "label": "nanocore",
                    "name": "NanoCore",
                    "score": 10,
                    "tags": [
                        "keylogger",
                        "trojan",
                        "stealer",
                        "spyware",
                        "family:nanocore"
                    ],
                    "desc": "NanoCore is a remote access tool (RAT) with a variety of capabilities."
                },
                {
                    "label": "reg_checks_country_code",
                    "name": "Checks computer location settings",
                    "score": 7,
                    "ttp": [
                        "T1012",
                        "T1082"
                    ],
                    "desc": "Looks up country code configured in the registry, likely geofence."
                },
                {
                    "label": "unexpected_dns",
                    "name": "Unexpected DNS network traffic destination",
                    "score": 7,
                    "desc": "Network traffic to other servers than the configured DNS servers was detected on the DNS port."
                },
                {
                    "label": "creates_runkey_registry",
                    "name": "Adds Run key to start application",
                    "score": 6,
                    "ttp": [
                        "T1060",
                        "T1112"
                    ],
                    "tags": [
                        "persistence"
                    ]
                },
                {
                    "label": "uac_status",
                    "name": "Checks whether UAC is enabled",
                    "score": 6,
                    "ttp": [
                        "T1082"
                    ],
                    "tags": [
                        "evasion",
                        "trojan"
                    ]
                },
                {
                    "name": "Suspicious use of SetThreadContext",
                    "score": 5
                },
                {
                    "label": "fw_programfiles",
                    "name": "Drops file in Program Files directory",
                    "score": 4
                },
                {
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": [
                        "T1082"
                    ],
                    "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour."
                },
                {
                    "label": "schtasks_persist",
                    "name": "Creates scheduled task(s)",
                    "ttp": [
                        "T1053"
                    ],
                    "tags": [
                        "persistence"
                    ],
                    "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution."
                },
                {
                    "name": "Suspicious behavior: EnumeratesProcesses"
                },
                {
                    "name": "Suspicious behavior: GetForegroundWindowSpam"
                },
                {
                    "name": "Suspicious use of AdjustPrivilegeToken"
                },
                {
                    "name": "Suspicious use of WriteProcessMemory"
                }
            ],
            "iocs": {
                "domains": [
                    "patriciawangs.duckdns.org",
                    "149.220.183.52.in-addr.arpa",
                    "154.25.221.88.in-addr.arpa",
                    "97.17.167.52.in-addr.arpa",
                    "76.38.195.152.in-addr.arpa",
                    "133.17.126.40.in-addr.arpa",
                    "86.192.144.4.in-addr.arpa",
                    "164.113.223.173.in-addr.arpa",
                    "104.219.191.52.in-addr.arpa",
                    "58.104.205.20.in-addr.arpa",
                    "202.74.101.95.in-addr.arpa",
                    "97.97.242.52.in-addr.arpa",
                    "2.36.159.162.in-addr.arpa",
                    "42.220.44.20.in-addr.arpa",
                    "216.74.101.95.in-addr.arpa",
                    "174.1.235.37.in-addr.arpa",
                    "11.175.53.84.in-addr.arpa",
                    "177.1.235.37.in-addr.arpa",
                    "103.169.127.40.in-addr.arpa",
                    "63.13.109.52.in-addr.arpa",
                    "226.101.242.52.in-addr.arpa"
                ],
                "ips": [
                    "37.235.1.174",
                    "37.235.1.177",
                    "8.8.8.8",
                    "212.193.30.230",
                    "93.184.220.29",
                    "20.54.89.15",
                    "8.241.135.254",
                    "209.197.3.8",
                    "127.0.0.1"
                ]
            }
        }
    ],
    "signatures": [
        {
            "label": "nanocore",
            "name": "NanoCore",
            "score": 10,
            "tags": [
                "keylogger",
                "trojan",
                "stealer",
                "spyware",
                "family:nanocore"
            ],
            "desc": "NanoCore is a remote access tool (RAT) with a variety of capabilities."
        },
        {
            "label": "reg_checks_country_code",
            "name": "Checks computer location settings",
            "score": 7,
            "ttp": [
                "T1012",
                "T1082"
            ],
            "desc": "Looks up country code configured in the registry, likely geofence."
        },
        {
            "label": "unexpected_dns",
            "name": "Unexpected DNS network traffic destination",
            "score": 7,
            "desc": "Network traffic to other servers than the configured DNS servers was detected on the DNS port."
        },
        {
            "label": "creates_runkey_registry",
            "name": "Adds Run key to start application",
            "score": 6,
            "ttp": [
                "T1060",
                "T1112"
            ],
            "tags": [
                "persistence"
            ]
        },
        {
            "label": "uac_status",
            "name": "Checks whether UAC is enabled",
            "score": 6,
            "ttp": [
                "T1082"
            ],
            "tags": [
                "evasion",
                "trojan"
            ]
        },
        {
            "name": "Suspicious use of SetThreadContext",
            "score": 5
        },
        {
            "label": "fw_programfiles",
            "name": "Drops file in Program Files directory",
            "score": 4
        },
        {
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": [
                "T1082"
            ],
            "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour."
        },
        {
            "label": "schtasks_persist",
            "name": "Creates scheduled task(s)",
            "ttp": [
                "T1053"
            ],
            "tags": [
                "persistence"
            ],
            "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution."
        },
        {
            "name": "Suspicious behavior: EnumeratesProcesses"
        },
        {
            "name": "Suspicious behavior: GetForegroundWindowSpam"
        },
        {
            "name": "Suspicious use of AdjustPrivilegeToken"
        },
        {
            "name": "Suspicious use of WriteProcessMemory"
        }
    ],
    "extracted": [
        {
            "tasks": [
                "behavioral1"
            ],
            "dumped_file": "memory/1208-76-0x0000000000400000-0x0000000000438000-memory.dmp",
            "resource": "behavioral1/memory/1208-76-0x0000000000400000-0x0000000000438000-memory.dmp",
            "config": {
                "family": "nanocore",
                "rule": "NanoCore"
            }
        },
        {
            "tasks": [
                "behavioral1",
                "behavioral2"
            ],
            "dumped_file": "memory/1208-79-0x0000000000400000-0x0000000000438000-memory.dmp",
            "resource": "behavioral1/memory/1208-79-0x0000000000400000-0x0000000000438000-memory.dmp",
            "config": {
                "family": "nanocore",
                "rule": "NanoCore",
                "c2": [
                    "patriciawangs.duckdns.org:4040",
                    "127.0.0.1:4040"
                ],
                "version": "1.2.2.0",
                "mutex": [
                    "2ff18631-9597-460a-9497-5830c27082f4"
                ],
                "dns": [
                    "37.235.1.174",
                    "37.235.1.177"
                ],
                "attr": {
                    "keyboard_logging": false,
                    "build_time": "2022-12-26T14:41:43.643553836Z",
                    "version": "1.2.2.0",
                    "mutex": "2ff18631-9597-460a-9497-5830c27082f4",
                    "default_group": "WORKD",
                    "primary_connection_host": "patriciawangs.duckdns.org",
                    "backup_connection_host": "127.0.0.1",
                    "connection_port": 4040,
                    "run_on_startup": false,
                    "request_elevation": true,
                    "bypass_user_account_control": true,
                    "bypass_user_account_control_data": null,
                    "clear_zone_identifier": false,
                    "clear_access_control": true,
                    "set_critical_process": true,
                    "prevent_system_sleep": false,
                    "activate_away_mode": true,
                    "enable_debug_mode": true,
                    "run_delay": 0,
                    "connect_delay": 4000,
                    "restart_delay": 5000,
                    "timeout_interval": 5000,
                    "keep_alive_timeout": 30000,
                    "mutex_timeout": 5000,
                    "lan_timeout": 2500,
                    "wan_timeout": 8000,
                    "buffer_size": 65535,
                    "max_packet_size": 10485760,
                    "gc_threshold": 10485760,
                    "use_custom_dns_server": false,
                    "primary_dns_server": "37.235.1.174",
                    "backup_dns_server": "37.235.1.177"
                }
            }
        }
    ]
}