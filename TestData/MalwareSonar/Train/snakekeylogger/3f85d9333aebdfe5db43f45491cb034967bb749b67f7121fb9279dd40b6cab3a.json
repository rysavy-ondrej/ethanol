{
    "version": "0.2.3",
    "sample": {
        "id": "230321-qqxzaaae99",
        "score": 10,
        "target": "3f85d9333aebdfe5db43f45491cb034967bb749b67f7121fb9279dd40b6cab3a.zip",
        "size": 1005798,
        "md5": "d4e810afa60d9012ec3c6fafb4dfe586",
        "sha1": "7efdb7e599d5609d299e545e4c1a510a6bd82734",
        "sha256": "dda0873ea5f341ee3a352e56253ba7a814a3540930e4979fe569e28fd78a9761",
        "sha512": "81c0de38636691fe1c6ee8a00f7077895d71daa164884be8ccfd4dc3dc5181a0e58155340f4dea430117e822430921b0ec7f747b32ccc258ae4d919daee0c6d6",
        "ssdeep": "24576:0xCm3QhB+0uoUbQOTsRvD6tLDec82wFSzjP1Hq6HFjab:tm+pbUML6t2c8hYX1HqR",
        "created": "2023-03-21T13:28:32Z",
        "completed": "2023-03-21T13:31:17Z"
    },
    "tasks": [
        {
            "sample": "230321-qqxzaaae99",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": [
                "family:snakekeylogger",
                "collection",
                "keylogger",
                "spyware",
                "stealer"
            ],
            "score": 10,
            "target": "3f85d9333aebdfe5db43f45491cb034967bb749b67f7121fb9279dd40b6cab3a.xls",
            "backend": "sbx4m18",
            "resource": "win7-20230220-en",
            "pick": "static1/unpack001/3f85d9333aebdfe5db43f45491cb034967bb749b67f7121fb9279dd40b6cab3a.xls",
            "os": "windows7-x64",
            "timeout": 150,
            "sigs": 24
        },
        {
            "sample": "230321-qqxzaaae99",
            "kind": "behavioral",
            "name": "behavioral2",
            "status": "reported",
            "score": 1,
            "target": "3f85d9333aebdfe5db43f45491cb034967bb749b67f7121fb9279dd40b6cab3a.xls",
            "backend": "sbx4m18",
            "resource": "win10v2004-20230220-en",
            "pick": "static1/unpack001/3f85d9333aebdfe5db43f45491cb034967bb749b67f7121fb9279dd40b6cab3a.xls",
            "os": "windows10-2004-x64",
            "timeout": 150,
            "sigs": 8
        },
        {
            "sample": "230321-qqxzaaae99",
            "kind": "static",
            "name": "static1",
            "status": "reported",
            "score": 1
        }
    ],
    "analysis": {
        "score": 10,
        "family": [
            "snakekeylogger"
        ],
        "tags": [
            "family:snakekeylogger",
            "collection",
            "keylogger",
            "spyware",
            "stealer"
        ]
    },
    "targets": [
        {
            "tasks": [
                "behavioral1",
                "behavioral2"
            ],
            "score": 10,
            "target": "3f85d9333aebdfe5db43f45491cb034967bb749b67f7121fb9279dd40b6cab3a.xls",
            "pick": "unpack001/3f85d9333aebdfe5db43f45491cb034967bb749b67f7121fb9279dd40b6cab3a.xls",
            "size": 1155584,
            "md5": "334e757302aa9a7e84aba337f1f48b87",
            "sha1": "4408fc675527182bf2defe7dc3352ace641f9371",
            "sha256": "3f85d9333aebdfe5db43f45491cb034967bb749b67f7121fb9279dd40b6cab3a",
            "sha512": "58644d68b2aef482aee090edd5f4c4a4fe1517fd5a46e6f5e326b114f7b067b80c93baa9b055299ea68823136ebec4f7ba62faa20bc22f90ef515e7d6a24f3d3",
            "ssdeep": "24576:XLKGWQmmav30xY+MXUu9/t3+MXUu9V3bVA+MXUu9G3bV0aCgm3+ifIVO8:XLK7QmmQ30q+MXV9p+MXV9V3bVA+MXVy",
            "tags": [
                "family:snakekeylogger",
                "collection",
                "keylogger",
                "spyware",
                "stealer"
            ],
            "family": [
                "snakekeylogger"
            ],
            "signatures": [
                {
                    "label": "snakekeylogger",
                    "name": "Snake Keylogger",
                    "score": 10,
                    "tags": [
                        "stealer",
                        "keylogger",
                        "family:snakekeylogger"
                    ],
                    "desc": "Keylogger and Infostealer first seen in November 2020."
                },
                {
                    "name": "Snake Keylogger payload",
                    "score": 10,
                    "indicators": [
                        {
                            "resource": "behavioral1/memory/1740-114-0x0000000000400000-0x0000000000426000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        },
                        {
                            "resource": "behavioral1/memory/1740-113-0x0000000000400000-0x0000000000426000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        },
                        {
                            "resource": "behavioral1/memory/1740-116-0x0000000000400000-0x0000000000426000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        },
                        {
                            "resource": "behavioral1/memory/1740-121-0x0000000000400000-0x0000000000426000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        },
                        {
                            "resource": "behavioral1/memory/1740-119-0x0000000000400000-0x0000000000426000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        },
                        {
                            "resource": "behavioral1/memory/1740-122-0x0000000001000000-0x0000000001040000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        },
                        {
                            "resource": "behavioral1/memory/1740-123-0x0000000001000000-0x0000000001040000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        }
                    ]
                },
                {
                    "name": "Blocklisted process makes network request",
                    "score": 8
                },
                {
                    "label": "download_pe",
                    "name": "Downloads MZ/PE file",
                    "score": 8
                },
                {
                    "name": "Executes dropped EXE",
                    "score": 7
                },
                {
                    "name": "Loads dropped DLL",
                    "score": 7
                },
                {
                    "label": "ftp_client_data_harvesting",
                    "name": "Reads data files stored by FTP clients",
                    "score": 7,
                    "ttp": [
                        "T1005",
                        "T1081"
                    ],
                    "tags": [
                        "spyware",
                        "stealer"
                    ],
                    "desc": "Tries to access configuration files associated with programs like FileZilla."
                },
                {
                    "label": "email_user_data_harvesting",
                    "name": "Reads user/profile data of local email clients",
                    "score": 7,
                    "ttp": [
                        "T1005",
                        "T1081"
                    ],
                    "tags": [
                        "spyware",
                        "stealer"
                    ],
                    "desc": "Email clients store some user data on disk where infostealers will often target it."
                },
                {
                    "label": "browser_user_data_harvesting",
                    "name": "Reads user/profile data of web browsers",
                    "score": 7,
                    "ttp": [
                        "T1005",
                        "T1081"
                    ],
                    "tags": [
                        "spyware",
                        "stealer"
                    ],
                    "desc": "Infostealers often target stored browser data, which can include saved credentials etc."
                },
                {
                    "label": "uses_vbs_compiler",
                    "name": "Uses the VBS compiler for execution",
                    "score": 7,
                    "ttp": [
                        "T1064"
                    ]
                },
                {
                    "label": "access_outlook_profiles",
                    "name": "Accesses Microsoft Outlook profiles",
                    "score": 6,
                    "ttp": [
                        "T1114"
                    ],
                    "tags": [
                        "collection"
                    ]
                },
                {
                    "label": "external_ip_lookup",
                    "name": "Looks up external IP address via web service",
                    "score": 6,
                    "desc": "Uses a legitimate IP lookup service to find the infected system's external IP."
                },
                {
                    "name": "Suspicious use of SetThreadContext",
                    "score": 5
                },
                {
                    "label": "reg_hw_processor",
                    "name": "Checks processor information in registry",
                    "ttp": [
                        "T1012",
                        "T1082"
                    ],
                    "desc": "Processor information is often read in order to detect sandboxing environments."
                },
                {
                    "label": "reg_hw_system",
                    "name": "Enumerates system info in registry",
                    "ttp": [
                        "T1012",
                        "T1082"
                    ]
                },
                {
                    "label": "starts_equation_editor",
                    "name": "Launches Equation Editor",
                    "ttp": [
                        "T1203"
                    ],
                    "tags": [
                        "exploit"
                    ],
                    "desc": "Equation Editor is an old Office component often targeted by exploits such as CVE-2017-11882."
                },
                {
                    "label": "modifies_iexplore_settings",
                    "name": "Modifies Internet Explorer settings",
                    "ttp": [
                        "T1112"
                    ],
                    "tags": [
                        "adware",
                        "spyware"
                    ]
                },
                {
                    "label": "reg_software_classes",
                    "name": "Modifies registry class"
                },
                {
                    "name": "Suspicious behavior: AddClipboardFormatListener"
                },
                {
                    "name": "Suspicious behavior: EnumeratesProcesses"
                },
                {
                    "name": "Suspicious use of AdjustPrivilegeToken"
                },
                {
                    "name": "Suspicious use of FindShellTrayWindow"
                },
                {
                    "name": "Suspicious use of SetWindowsHookEx"
                },
                {
                    "name": "Suspicious use of WriteProcessMemory"
                },
                {
                    "label": "win_tasksched_com_clsid",
                    "name": "Uses Task Scheduler COM API",
                    "ttp": [
                        "T1012"
                    ],
                    "tags": [
                        "persistence"
                    ],
                    "desc": "The Task Scheduler COM API can be used to schedule applications to run on boot or at set times."
                },
                {
                    "label": "win_volshadow_wmi_clsid",
                    "name": "Uses Volume Shadow Copy WMI provider",
                    "tags": [
                        "ransomware"
                    ],
                    "desc": "The Volume Shadow Copy service is used to manage backups/snapshots."
                },
                {
                    "label": "win_volshadow_com_clsid",
                    "name": "Uses Volume Shadow Copy service COM API",
                    "tags": [
                        "ransomware"
                    ],
                    "desc": "The Volume Shadow Copy service is used to manage backups/snapshots."
                },
                {
                    "label": "outlook_office_path",
                    "name": "outlook_office_path"
                },
                {
                    "label": "outlook_win_path",
                    "name": "outlook_win_path"
                }
            ],
            "iocs": {
                "urls": [
                    "http://202.55.132.230/281/vbc.exe",
                    "http://checkip.dyndns.org/"
                ],
                "domains": [
                    "checkip.dyndns.org",
                    "13.86.106.20.in-addr.arpa",
                    "24.32.109.52.in-addr.arpa",
                    "72.150.172.52.in-addr.arpa",
                    "199.176.139.52.in-addr.arpa",
                    "76.38.195.152.in-addr.arpa",
                    "27.178.89.13.in-addr.arpa",
                    "76.32.126.40.in-addr.arpa",
                    "132.17.126.40.in-addr.arpa",
                    "58.55.71.13.in-addr.arpa",
                    "2.77.109.52.in-addr.arpa",
                    "17.160.190.20.in-addr.arpa",
                    "126.132.255.8.in-addr.arpa",
                    "216.74.101.95.in-addr.arpa",
                    "143.145.190.20.in-addr.arpa",
                    "202.74.101.95.in-addr.arpa",
                    "123.108.74.40.in-addr.arpa"
                ],
                "ips": [
                    "202.55.132.230",
                    "8.8.8.8",
                    "132.226.8.169",
                    "152.195.38.76",
                    "93.184.221.240",
                    "52.152.110.14",
                    "13.89.179.10",
                    "173.223.113.164",
                    "20.190.160.22"
                ]
            }
        }
    ],
    "signatures": [
        {
            "label": "snakekeylogger",
            "name": "Snake Keylogger",
            "score": 10,
            "tags": [
                "stealer",
                "keylogger",
                "family:snakekeylogger"
            ],
            "desc": "Keylogger and Infostealer first seen in November 2020."
        },
        {
            "name": "Snake Keylogger payload",
            "score": 10,
            "indicators": [
                {
                    "resource": "behavioral1/memory/1740-114-0x0000000000400000-0x0000000000426000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                },
                {
                    "resource": "behavioral1/memory/1740-113-0x0000000000400000-0x0000000000426000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                },
                {
                    "resource": "behavioral1/memory/1740-116-0x0000000000400000-0x0000000000426000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                },
                {
                    "resource": "behavioral1/memory/1740-121-0x0000000000400000-0x0000000000426000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                },
                {
                    "resource": "behavioral1/memory/1740-119-0x0000000000400000-0x0000000000426000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                },
                {
                    "resource": "behavioral1/memory/1740-122-0x0000000001000000-0x0000000001040000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                },
                {
                    "resource": "behavioral1/memory/1740-123-0x0000000001000000-0x0000000001040000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                }
            ]
        },
        {
            "name": "Blocklisted process makes network request",
            "score": 8
        },
        {
            "label": "download_pe",
            "name": "Downloads MZ/PE file",
            "score": 8
        },
        {
            "name": "Executes dropped EXE",
            "score": 7
        },
        {
            "name": "Loads dropped DLL",
            "score": 7
        },
        {
            "label": "ftp_client_data_harvesting",
            "name": "Reads data files stored by FTP clients",
            "score": 7,
            "ttp": [
                "T1005",
                "T1081"
            ],
            "tags": [
                "spyware",
                "stealer"
            ],
            "desc": "Tries to access configuration files associated with programs like FileZilla."
        },
        {
            "label": "email_user_data_harvesting",
            "name": "Reads user/profile data of local email clients",
            "score": 7,
            "ttp": [
                "T1005",
                "T1081"
            ],
            "tags": [
                "spyware",
                "stealer"
            ],
            "desc": "Email clients store some user data on disk where infostealers will often target it."
        },
        {
            "label": "browser_user_data_harvesting",
            "name": "Reads user/profile data of web browsers",
            "score": 7,
            "ttp": [
                "T1005",
                "T1081"
            ],
            "tags": [
                "spyware",
                "stealer"
            ],
            "desc": "Infostealers often target stored browser data, which can include saved credentials etc."
        },
        {
            "label": "uses_vbs_compiler",
            "name": "Uses the VBS compiler for execution",
            "score": 7,
            "ttp": [
                "T1064"
            ]
        },
        {
            "label": "access_outlook_profiles",
            "name": "Accesses Microsoft Outlook profiles",
            "score": 6,
            "ttp": [
                "T1114"
            ],
            "tags": [
                "collection"
            ]
        },
        {
            "label": "external_ip_lookup",
            "name": "Looks up external IP address via web service",
            "score": 6,
            "desc": "Uses a legitimate IP lookup service to find the infected system's external IP."
        },
        {
            "name": "Suspicious use of SetThreadContext",
            "score": 5
        },
        {
            "label": "reg_hw_processor",
            "name": "Checks processor information in registry",
            "ttp": [
                "T1012",
                "T1082"
            ],
            "desc": "Processor information is often read in order to detect sandboxing environments."
        },
        {
            "label": "reg_hw_system",
            "name": "Enumerates system info in registry",
            "ttp": [
                "T1012",
                "T1082"
            ]
        },
        {
            "label": "starts_equation_editor",
            "name": "Launches Equation Editor",
            "ttp": [
                "T1203"
            ],
            "tags": [
                "exploit"
            ],
            "desc": "Equation Editor is an old Office component often targeted by exploits such as CVE-2017-11882."
        },
        {
            "label": "modifies_iexplore_settings",
            "name": "Modifies Internet Explorer settings",
            "ttp": [
                "T1112"
            ],
            "tags": [
                "adware",
                "spyware"
            ]
        },
        {
            "label": "reg_software_classes",
            "name": "Modifies registry class"
        },
        {
            "name": "Suspicious behavior: AddClipboardFormatListener"
        },
        {
            "name": "Suspicious behavior: EnumeratesProcesses"
        },
        {
            "name": "Suspicious use of AdjustPrivilegeToken"
        },
        {
            "name": "Suspicious use of FindShellTrayWindow"
        },
        {
            "name": "Suspicious use of SetWindowsHookEx"
        },
        {
            "name": "Suspicious use of WriteProcessMemory"
        },
        {
            "label": "win_tasksched_com_clsid",
            "name": "Uses Task Scheduler COM API",
            "ttp": [
                "T1012"
            ],
            "tags": [
                "persistence"
            ],
            "desc": "The Task Scheduler COM API can be used to schedule applications to run on boot or at set times."
        },
        {
            "label": "win_volshadow_wmi_clsid",
            "name": "Uses Volume Shadow Copy WMI provider",
            "tags": [
                "ransomware"
            ],
            "desc": "The Volume Shadow Copy service is used to manage backups/snapshots."
        },
        {
            "label": "win_volshadow_com_clsid",
            "name": "Uses Volume Shadow Copy service COM API",
            "tags": [
                "ransomware"
            ],
            "desc": "The Volume Shadow Copy service is used to manage backups/snapshots."
        },
        {
            "label": "outlook_office_path",
            "name": "outlook_office_path"
        },
        {
            "label": "outlook_win_path",
            "name": "outlook_win_path"
        }
    ],
    "extracted": [
        {
            "tasks": [
                "behavioral1"
            ],
            "dumped_file": "memory/1740-114-0x0000000000400000-0x0000000000426000-memory.dmp",
            "resource": "behavioral1/memory/1740-114-0x0000000000400000-0x0000000000426000-memory.dmp",
            "config": {
                "family": "snakekeylogger",
                "rule": "SnakeKeylogger",
                "c2": [
                    "https://api.telegram.org/bot6011587164:AAE511fkFXh2HFxNMsjh7DJ7AykzyWIVuaY/sendMessage?chat_id=6197263581"
                ]
            }
        }
    ]
}