{
    "version": "0.2.3",
    "sample": {
        "id": "230321-qqywkscf4z",
        "score": 10,
        "target": "775d529b622e56fca4a1ffcc6632c3c89b188cb773c88438c525fd4a69a27d67.zip",
        "size": 712528,
        "md5": "14285a19eec817f1d4c50ce8ee30340f",
        "sha1": "18fa269d01a0c2511f0b4459d5632169ff320737",
        "sha256": "eb9aefef287c97aee204e25c5ef5d464cdb681b1a03b9fe729e980e11c6f487b",
        "sha512": "a50e1a112351a7a8c18311b59fcceb61d0cccbd15a8605d0f4c0dd72f38a0e163718e9602ff3eaebf066fc290a93dba9030e4e5030fae85c4437014e7c3a4fad",
        "ssdeep": "12288:pW0XVHA/WVq8EI8kSbZXFL9aN+zFmj++8G8REvAvQ9CWWVtTza:pLtwp8upFg+HGavQ9CvVhm",
        "created": "2023-03-21T13:28:35Z",
        "completed": "2023-03-21T13:31:17Z"
    },
    "tasks": [
        {
            "sample": "230321-qqywkscf4z",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "tags": [
                "family:snakekeylogger",
                "collection",
                "keylogger",
                "spyware",
                "stealer"
            ],
            "score": 10,
            "target": "775d529b622e56fca4a1ffcc6632c3c89b188cb773c88438c525fd4a69a27d67.exe",
            "backend": "sbx4m12",
            "resource": "win7-20230220-en",
            "pick": "static1/unpack001/775d529b622e56fca4a1ffcc6632c3c89b188cb773c88438c525fd4a69a27d67.exe",
            "os": "windows7-x64",
            "timeout": 150,
            "sigs": 15
        },
        {
            "sample": "230321-qqywkscf4z",
            "kind": "behavioral",
            "name": "behavioral2",
            "status": "reported",
            "tags": [
                "family:snakekeylogger",
                "collection",
                "keylogger",
                "spyware",
                "stealer"
            ],
            "score": 10,
            "target": "775d529b622e56fca4a1ffcc6632c3c89b188cb773c88438c525fd4a69a27d67.exe",
            "backend": "fu1m1",
            "resource": "win10v2004-20230220-en",
            "pick": "static1/unpack001/775d529b622e56fca4a1ffcc6632c3c89b188cb773c88438c525fd4a69a27d67.exe",
            "os": "windows10-2004-x64",
            "timeout": 150,
            "sigs": 16
        },
        {
            "sample": "230321-qqywkscf4z",
            "kind": "static",
            "name": "static1",
            "status": "reported",
            "score": 1
        }
    ],
    "analysis": {
        "score": 10,
        "family": [
            "snakekeylogger"
        ],
        "tags": [
            "family:snakekeylogger",
            "collection",
            "keylogger",
            "spyware",
            "stealer"
        ]
    },
    "targets": [
        {
            "tasks": [
                "behavioral1",
                "behavioral2"
            ],
            "score": 10,
            "target": "775d529b622e56fca4a1ffcc6632c3c89b188cb773c88438c525fd4a69a27d67.exe",
            "pick": "unpack001/775d529b622e56fca4a1ffcc6632c3c89b188cb773c88438c525fd4a69a27d67.exe",
            "size": 836096,
            "md5": "149a233b91ae4b3ee57d9cde29d114de",
            "sha1": "412f07ccdbe832b139a6cbe136ef9c436a93347e",
            "sha256": "775d529b622e56fca4a1ffcc6632c3c89b188cb773c88438c525fd4a69a27d67",
            "sha512": "fcf0e181d5798d9271fc4ccb801696a9e03e6592000df49627af5a06a3b07e0727b599cb00e88b353a27b975fb79d7c11488fca41fdac7d3b2e78239a4083c37",
            "ssdeep": "12288:h3wQXyuaqBwGO33EmDKcbU71iCKuKTbrReVQ+KqUaJ/BFyzv0vYO33uqbN:dl+yynEmDKcbRCGTBwQ+RUaszv0vD3",
            "tags": [
                "family:snakekeylogger",
                "collection",
                "keylogger",
                "spyware",
                "stealer"
            ],
            "family": [
                "snakekeylogger"
            ],
            "signatures": [
                {
                    "label": "snakekeylogger",
                    "name": "Snake Keylogger",
                    "score": 10,
                    "tags": [
                        "stealer",
                        "keylogger",
                        "family:snakekeylogger"
                    ],
                    "desc": "Keylogger and Infostealer first seen in November 2020."
                },
                {
                    "name": "Snake Keylogger payload",
                    "score": 10,
                    "indicators": [
                        {
                            "resource": "behavioral1/memory/832-71-0x0000000000400000-0x0000000000426000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        },
                        {
                            "resource": "behavioral1/memory/832-72-0x0000000000400000-0x0000000000426000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        },
                        {
                            "resource": "behavioral1/memory/832-74-0x0000000000400000-0x0000000000426000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        },
                        {
                            "resource": "behavioral1/memory/832-76-0x0000000000400000-0x0000000000426000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        },
                        {
                            "resource": "behavioral1/memory/832-78-0x0000000000400000-0x0000000000426000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        },
                        {
                            "resource": "behavioral1/memory/672-79-0x0000000002760000-0x00000000027A0000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        },
                        {
                            "resource": "behavioral2/memory/4956-148-0x0000000000400000-0x0000000000426000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        }
                    ]
                },
                {
                    "label": "reg_checks_country_code",
                    "name": "Checks computer location settings",
                    "score": 7,
                    "ttp": [
                        "T1012",
                        "T1082"
                    ],
                    "desc": "Looks up country code configured in the registry, likely geofence."
                },
                {
                    "label": "ftp_client_data_harvesting",
                    "name": "Reads data files stored by FTP clients",
                    "score": 7,
                    "ttp": [
                        "T1005",
                        "T1081"
                    ],
                    "tags": [
                        "spyware",
                        "stealer"
                    ],
                    "desc": "Tries to access configuration files associated with programs like FileZilla."
                },
                {
                    "label": "email_user_data_harvesting",
                    "name": "Reads user/profile data of local email clients",
                    "score": 7,
                    "ttp": [
                        "T1005",
                        "T1081"
                    ],
                    "tags": [
                        "spyware",
                        "stealer"
                    ],
                    "desc": "Email clients store some user data on disk where infostealers will often target it."
                },
                {
                    "label": "browser_user_data_harvesting",
                    "name": "Reads user/profile data of web browsers",
                    "score": 7,
                    "ttp": [
                        "T1005",
                        "T1081"
                    ],
                    "tags": [
                        "spyware",
                        "stealer"
                    ],
                    "desc": "Infostealers often target stored browser data, which can include saved credentials etc."
                },
                {
                    "label": "access_outlook_profiles",
                    "name": "Accesses Microsoft Outlook profiles",
                    "score": 6,
                    "ttp": [
                        "T1114"
                    ],
                    "tags": [
                        "collection"
                    ]
                },
                {
                    "label": "external_ip_lookup",
                    "name": "Looks up external IP address via web service",
                    "score": 6,
                    "desc": "Uses a legitimate IP lookup service to find the infected system's external IP."
                },
                {
                    "name": "Suspicious use of SetThreadContext",
                    "score": 5
                },
                {
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": [
                        "T1082"
                    ],
                    "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour."
                },
                {
                    "label": "schtasks_persist",
                    "name": "Creates scheduled task(s)",
                    "ttp": [
                        "T1053"
                    ],
                    "tags": [
                        "persistence"
                    ],
                    "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution."
                },
                {
                    "name": "Suspicious behavior: EnumeratesProcesses"
                },
                {
                    "name": "Suspicious use of AdjustPrivilegeToken"
                },
                {
                    "name": "Suspicious use of WriteProcessMemory"
                },
                {
                    "label": "outlook_office_path",
                    "name": "outlook_office_path"
                },
                {
                    "label": "outlook_win_path",
                    "name": "outlook_win_path"
                }
            ],
            "iocs": {
                "urls": [
                    "http://checkip.dyndns.org/"
                ],
                "domains": [
                    "checkip.dyndns.org",
                    "217.106.137.52.in-addr.arpa",
                    "76.38.195.152.in-addr.arpa",
                    "210.81.184.52.in-addr.arpa",
                    "154.239.44.20.in-addr.arpa",
                    "216.74.101.95.in-addr.arpa",
                    "176.122.125.40.in-addr.arpa",
                    "0.130.122.193.in-addr.arpa",
                    "0.77.109.52.in-addr.arpa"
                ],
                "ips": [
                    "8.8.8.8",
                    "132.226.8.169",
                    "209.197.3.8",
                    "192.229.221.95",
                    "51.105.71.137",
                    "193.122.130.0"
                ]
            }
        }
    ],
    "signatures": [
        {
            "label": "snakekeylogger",
            "name": "Snake Keylogger",
            "score": 10,
            "tags": [
                "stealer",
                "keylogger",
                "family:snakekeylogger"
            ],
            "desc": "Keylogger and Infostealer first seen in November 2020."
        },
        {
            "name": "Snake Keylogger payload",
            "score": 10,
            "indicators": [
                {
                    "resource": "behavioral1/memory/832-71-0x0000000000400000-0x0000000000426000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                },
                {
                    "resource": "behavioral1/memory/832-72-0x0000000000400000-0x0000000000426000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                },
                {
                    "resource": "behavioral1/memory/832-74-0x0000000000400000-0x0000000000426000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                },
                {
                    "resource": "behavioral1/memory/832-76-0x0000000000400000-0x0000000000426000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                },
                {
                    "resource": "behavioral1/memory/832-78-0x0000000000400000-0x0000000000426000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                },
                {
                    "resource": "behavioral1/memory/672-79-0x0000000002760000-0x00000000027A0000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                },
                {
                    "resource": "behavioral2/memory/4956-148-0x0000000000400000-0x0000000000426000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                }
            ]
        },
        {
            "label": "reg_checks_country_code",
            "name": "Checks computer location settings",
            "score": 7,
            "ttp": [
                "T1012",
                "T1082"
            ],
            "desc": "Looks up country code configured in the registry, likely geofence."
        },
        {
            "label": "ftp_client_data_harvesting",
            "name": "Reads data files stored by FTP clients",
            "score": 7,
            "ttp": [
                "T1005",
                "T1081"
            ],
            "tags": [
                "spyware",
                "stealer"
            ],
            "desc": "Tries to access configuration files associated with programs like FileZilla."
        },
        {
            "label": "email_user_data_harvesting",
            "name": "Reads user/profile data of local email clients",
            "score": 7,
            "ttp": [
                "T1005",
                "T1081"
            ],
            "tags": [
                "spyware",
                "stealer"
            ],
            "desc": "Email clients store some user data on disk where infostealers will often target it."
        },
        {
            "label": "browser_user_data_harvesting",
            "name": "Reads user/profile data of web browsers",
            "score": 7,
            "ttp": [
                "T1005",
                "T1081"
            ],
            "tags": [
                "spyware",
                "stealer"
            ],
            "desc": "Infostealers often target stored browser data, which can include saved credentials etc."
        },
        {
            "label": "access_outlook_profiles",
            "name": "Accesses Microsoft Outlook profiles",
            "score": 6,
            "ttp": [
                "T1114"
            ],
            "tags": [
                "collection"
            ]
        },
        {
            "label": "external_ip_lookup",
            "name": "Looks up external IP address via web service",
            "score": 6,
            "desc": "Uses a legitimate IP lookup service to find the infected system's external IP."
        },
        {
            "name": "Suspicious use of SetThreadContext",
            "score": 5
        },
        {
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": [
                "T1082"
            ],
            "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour."
        },
        {
            "label": "schtasks_persist",
            "name": "Creates scheduled task(s)",
            "ttp": [
                "T1053"
            ],
            "tags": [
                "persistence"
            ],
            "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution."
        },
        {
            "name": "Suspicious behavior: EnumeratesProcesses"
        },
        {
            "name": "Suspicious use of AdjustPrivilegeToken"
        },
        {
            "name": "Suspicious use of WriteProcessMemory"
        },
        {
            "label": "outlook_office_path",
            "name": "outlook_office_path"
        },
        {
            "label": "outlook_win_path",
            "name": "outlook_win_path"
        }
    ],
    "extracted": [
        {
            "tasks": [
                "behavioral1",
                "behavioral2"
            ],
            "dumped_file": "memory/832-71-0x0000000000400000-0x0000000000426000-memory.dmp",
            "resource": "behavioral1/memory/832-71-0x0000000000400000-0x0000000000426000-memory.dmp",
            "config": {
                "family": "snakekeylogger",
                "rule": "SnakeKeylogger",
                "credentials": [
                    {
                        "protocol": "smtp",
                        "host": "valleycountysar.org",
                        "port": 26,
                        "username": "mbown@valleycountysar.org",
                        "password": "}eQA)VL2!$V}"
                    }
                ]
            }
        }
    ]
}