{
    "version": "0.2.3",
    "sample": {
        "id": "230321-qqzg4scf5t",
        "score": 10,
        "target": "af4ad10f654b460da90e68d1592f3cf396a1052b39bcdabd6f13b2f9a5891624.zip",
        "size": 841087,
        "md5": "027fbabd132fa9105e49ed813dc88732",
        "sha1": "e7c5aedad0e40e180c3e74f7a4955c8fe8c6b43f",
        "sha256": "843e0246090ef15146f1c8ecef896c07a3d62e4a433f071e6f84f407e554cba8",
        "sha512": "612561d467d04de72e20f93e71cde324c9977e2af4376d78bb45cf8c53f261890664e310c1f8ee063baa036efd1ce4e89a512fc2a845b11c0099da9f0e1eff37",
        "ssdeep": "24576:4fk6mBD8igcuZuAAuRlyUYuxJPrizeY86SPqX:ArmBDbuZuNEyUYQkzzX",
        "created": "2023-03-21T13:28:37Z",
        "completed": "2023-03-21T13:31:16Z"
    },
    "tasks": [
        {
            "sample": "230321-qqzg4scf5t",
            "kind": "behavioral",
            "name": "behavioral1",
            "status": "reported",
            "score": 3,
            "target": "af4ad10f654b460da90e68d1592f3cf396a1052b39bcdabd6f13b2f9a5891624.exe",
            "backend": "sbx4m19",
            "resource": "win7-20230220-en",
            "pick": "static1/unpack001/af4ad10f654b460da90e68d1592f3cf396a1052b39bcdabd6f13b2f9a5891624.exe",
            "os": "windows7-x64",
            "timeout": 150,
            "sigs": 5
        },
        {
            "sample": "230321-qqzg4scf5t",
            "kind": "behavioral",
            "name": "behavioral2",
            "status": "reported",
            "tags": [
                "family:snakekeylogger",
                "keylogger",
                "stealer"
            ],
            "score": 10,
            "target": "af4ad10f654b460da90e68d1592f3cf396a1052b39bcdabd6f13b2f9a5891624.exe",
            "backend": "sbx4m18",
            "resource": "win10v2004-20230220-en",
            "pick": "static1/unpack001/af4ad10f654b460da90e68d1592f3cf396a1052b39bcdabd6f13b2f9a5891624.exe",
            "os": "windows10-2004-x64",
            "timeout": 150,
            "sigs": 11
        },
        {
            "sample": "230321-qqzg4scf5t",
            "kind": "static",
            "name": "static1",
            "status": "reported",
            "score": 1
        }
    ],
    "analysis": {
        "score": 10,
        "family": [
            "snakekeylogger"
        ],
        "tags": [
            "family:snakekeylogger",
            "keylogger",
            "stealer"
        ]
    },
    "targets": [
        {
            "tasks": [
                "behavioral1",
                "behavioral2"
            ],
            "score": 10,
            "target": "af4ad10f654b460da90e68d1592f3cf396a1052b39bcdabd6f13b2f9a5891624.exe",
            "pick": "unpack001/af4ad10f654b460da90e68d1592f3cf396a1052b39bcdabd6f13b2f9a5891624.exe",
            "size": 899584,
            "md5": "342d347ee5afb4c16fb543f80dfba65e",
            "sha1": "b09d307b860b8eb3276127e42a6a8a7383106d1b",
            "sha256": "af4ad10f654b460da90e68d1592f3cf396a1052b39bcdabd6f13b2f9a5891624",
            "sha512": "fdd50632b66a5f8cc8e7e04afd031c2181df9016d23889dc0c980d7c0401f0f487f0771547caeb63b8f4d9267be8fe1496c4b17fd69a3119b02bedd34322a5ee",
            "ssdeep": "24576:xt9dzMhnkV7U+hFJBwhWhdAoWXlb9LLbPJDh:x7ukVRhFJBVW9X",
            "tags": [
                "family:snakekeylogger",
                "keylogger",
                "stealer"
            ],
            "family": [
                "snakekeylogger"
            ],
            "signatures": [
                {
                    "label": "snakekeylogger",
                    "name": "Snake Keylogger",
                    "score": 10,
                    "tags": [
                        "stealer",
                        "keylogger",
                        "family:snakekeylogger"
                    ],
                    "desc": "Keylogger and Infostealer first seen in November 2020."
                },
                {
                    "name": "Snake Keylogger payload",
                    "score": 10,
                    "indicators": [
                        {
                            "resource": "behavioral2/memory/1608-160-0x0000000000400000-0x0000000000426000-memory.dmp",
                            "yara_rule": "family_snakekeylogger"
                        }
                    ]
                },
                {
                    "label": "reg_checks_country_code",
                    "name": "Checks computer location settings",
                    "score": 7,
                    "ttp": [
                        "T1012",
                        "T1082"
                    ],
                    "desc": "Looks up country code configured in the registry, likely geofence."
                },
                {
                    "label": "external_ip_lookup",
                    "name": "Looks up external IP address via web service",
                    "score": 6,
                    "desc": "Uses a legitimate IP lookup service to find the infected system's external IP."
                },
                {
                    "name": "Suspicious use of SetThreadContext",
                    "score": 5
                },
                {
                    "label": "file_antivm_ide_drive",
                    "name": "Enumerates physical storage devices",
                    "score": 3,
                    "ttp": [
                        "T1082"
                    ],
                    "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour."
                },
                {
                    "label": "program_crash",
                    "name": "Program crash",
                    "score": 3
                },
                {
                    "label": "schtasks_persist",
                    "name": "Creates scheduled task(s)",
                    "ttp": [
                        "T1053"
                    ],
                    "tags": [
                        "persistence"
                    ],
                    "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution."
                },
                {
                    "name": "Suspicious behavior: EnumeratesProcesses"
                },
                {
                    "name": "Suspicious use of AdjustPrivilegeToken"
                },
                {
                    "name": "Suspicious use of WriteProcessMemory"
                }
            ],
            "iocs": {
                "urls": [
                    "http://checkip.dyndns.org/"
                ],
                "domains": [
                    "42.220.44.20.in-addr.arpa",
                    "209.205.72.20.in-addr.arpa",
                    "76.38.195.152.in-addr.arpa",
                    "217.106.137.52.in-addr.arpa",
                    "140.32.126.40.in-addr.arpa",
                    "58.55.71.13.in-addr.arpa",
                    "154.25.221.88.in-addr.arpa",
                    "206.23.85.13.in-addr.arpa",
                    "2.36.159.162.in-addr.arpa",
                    "62.13.109.52.in-addr.arpa",
                    "f.7.6.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.7.0.0.0.0.3.0.1.3.0.6.2.ip6.arpa",
                    "13.86.106.20.in-addr.arpa",
                    "checkip.dyndns.org",
                    "169.8.226.132.in-addr.arpa",
                    "210.81.184.52.in-addr.arpa",
                    "131.17.126.40.in-addr.arpa",
                    "86.192.144.4.in-addr.arpa",
                    "164.113.223.173.in-addr.arpa",
                    "84.150.43.20.in-addr.arpa",
                    "123.108.74.40.in-addr.arpa",
                    "149.220.183.52.in-addr.arpa",
                    "99.113.223.173.in-addr.arpa",
                    "113.66.64.40.in-addr.arpa",
                    "250.255.255.239.in-addr.arpa",
                    "121.175.53.84.in-addr.arpa",
                    "50.4.107.13.in-addr.arpa",
                    "0.205.248.87.in-addr.arpa",
                    "0.204.248.87.in-addr.arpa",
                    "9.195.19.2.in-addr.arpa",
                    "240.232.229.192.in-addr.arpa",
                    "202.74.101.95.in-addr.arpa",
                    "126.137.241.8.in-addr.arpa",
                    "72.77.123.92.in-addr.arpa"
                ],
                "ips": [
                    "52.109.77.2",
                    "152.195.38.76",
                    "8.8.8.8",
                    "209.197.3.8",
                    "132.226.8.169"
                ]
            }
        }
    ],
    "signatures": [
        {
            "label": "snakekeylogger",
            "name": "Snake Keylogger",
            "score": 10,
            "tags": [
                "stealer",
                "keylogger",
                "family:snakekeylogger"
            ],
            "desc": "Keylogger and Infostealer first seen in November 2020."
        },
        {
            "name": "Snake Keylogger payload",
            "score": 10,
            "indicators": [
                {
                    "resource": "behavioral2/memory/1608-160-0x0000000000400000-0x0000000000426000-memory.dmp",
                    "yara_rule": "family_snakekeylogger"
                }
            ]
        },
        {
            "label": "reg_checks_country_code",
            "name": "Checks computer location settings",
            "score": 7,
            "ttp": [
                "T1012",
                "T1082"
            ],
            "desc": "Looks up country code configured in the registry, likely geofence."
        },
        {
            "label": "external_ip_lookup",
            "name": "Looks up external IP address via web service",
            "score": 6,
            "desc": "Uses a legitimate IP lookup service to find the infected system's external IP."
        },
        {
            "name": "Suspicious use of SetThreadContext",
            "score": 5
        },
        {
            "label": "file_antivm_ide_drive",
            "name": "Enumerates physical storage devices",
            "score": 3,
            "ttp": [
                "T1082"
            ],
            "desc": "Attempts to interact with connected storage/optical drive(s). Likely ransomware behaviour."
        },
        {
            "label": "program_crash",
            "name": "Program crash",
            "score": 3
        },
        {
            "label": "schtasks_persist",
            "name": "Creates scheduled task(s)",
            "ttp": [
                "T1053"
            ],
            "tags": [
                "persistence"
            ],
            "desc": "Schtasks is often used by malware for persistence or to perform post-infection execution."
        },
        {
            "name": "Suspicious behavior: EnumeratesProcesses"
        },
        {
            "name": "Suspicious use of AdjustPrivilegeToken"
        },
        {
            "name": "Suspicious use of WriteProcessMemory"
        }
    ],
    "extracted": [
        {
            "tasks": [
                "behavioral2"
            ],
            "dumped_file": "memory/1608-160-0x0000000000400000-0x0000000000426000-memory.dmp",
            "resource": "behavioral2/memory/1608-160-0x0000000000400000-0x0000000000426000-memory.dmp",
            "config": {
                "family": "snakekeylogger",
                "rule": "SnakeKeylogger",
                "c2": [
                    "https://api.telegram.org/bot6139793960:AAHb1pvRqCPkUdPwQAk890wA9oCHnQ-VPaY/sendMessage?chat_id=935548406"
                ]
            }
        }
    ]
}