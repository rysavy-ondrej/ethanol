if ($null -eq $ethanolExe){ $ethanolExe  = "../../Source/Ethanol.Cli/bin/Debug/net7.0/ethanol" }

Write-Host "Testing MalwareSonar:" -ForegroundColor Yellow -BackgroundColor DarkGreen

Write-Host  "● Test 1: learn profile" -ForegroundColor Yellow -BackgroundColor DarkGreen
Write-Host

& $ethanolExe malware learn -r Train -o Models/lightblue.mal

Write-Host  "● Test 2: scan-malware ctx-tor" -ForegroundColor Yellow -BackgroundColor DarkGreen
Write-Host

& $ethanolExe malware scan -p ./Models/lightblue.mal -i ./ContextData/ctx-tor.json -o ./TestResults/ctx-tor.tested.json > ./TestResults/ctx-tor.log

Write-Host  "● Test 3: scan-malware bening1" -ForegroundColor Yellow -BackgroundColor DarkGreen
Write-Host

& $ethanolExe malware scan -p .\Models\lightblue.mal -i .\ContextData\ctx-bening1.json -o .\TestResults\ctx-bening1.tested.json > .\TestResults\ctx-bening1.log

Write-Host  "● Test 4: scan-malware bening2" -ForegroundColor Yellow -BackgroundColor DarkGreen
Write-Host

& $ethanolExe malware scan -p .\Models\lightblue.mal -i .\ContextData\ctx-bening2.json -o .\TestResults\ctx-bening2.tested.json > .\TestResults\ctx-bening2.log

Write-Host  "● Test 5: scan-malware infected" -ForegroundColor Yellow -BackgroundColor DarkGreen
Write-Host

& $ethanolExe malware scan -p .\Models\lightblue.mal -i .\ContextData\ctx-infected.json -o .\TestResults\ctx-infected.tested.json -t 0.8 > .\TestResults\ctx-infected.log