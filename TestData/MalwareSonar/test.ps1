if ($null -eq $ethanolExe){ $ethanolExe  = "../../Source/Ethanol.Cli/bin/Debug/net7.0/ethanol" }

Write-Host "Testing MalwareSonar:" -ForegroundColor Yellow -BackgroundColor DarkGreen

Write-Host  "● Test1: learn profile" -ForegroundColor Yellow -BackgroundColor DarkGreen
Write-Host

& $ethanolExe learn-malfile -r Train -o Models/lightblue.mal

Write-Host  "● Test1: infect context" -ForegroundColor Yellow -BackgroundColor DarkGreen
Write-Host
& $ethanolExe infect-context -i ContextData/ctx-bening1.json -r Test -o ContextData/ctx-infected.json

Write-Host  "● Test1: scan-malware ctx-tor" -ForegroundColor Yellow -BackgroundColor DarkGreen
Write-Host

& $ethanolExe scan-malware -p ./Models/lightblue.mal -i ./ContextData/ctx-tor.json -o ./TestResults/ctx-tor.tested.json > ./TestResults/ctx-tor.log

Write-Host  "● Test2: scan-malware bening1" -ForegroundColor Yellow -BackgroundColor DarkGreen
Write-Host

& $ethanolExe scan-malware -p .\Models\lightblue.mal -i .\ContextData\ctx-bening1.json -o .\TestResults\ctx-bening1.tested.json > .\TestResults\ctx-bening1.log

Write-Host  "● Test1: scan-malware bening2" -ForegroundColor Yellow -BackgroundColor DarkGreen
Write-Host

& $ethanolExe scan-malware -p .\Models\lightblue.mal -i .\ContextData\ctx-bening2.json -o .\TestResults\ctx-bening2.tested.json > .\TestResults\ctx-bening2.log

Write-Host  "● Test1: scan-malware anyrun" -ForegroundColor Yellow -BackgroundColor DarkGreen
Write-Host

& $ethanolExe scan-malware -p .\Models\lightblue.mal -i .\ContextData\ctx-anyrun.json -o .\TestResults\ctx-anyrun.tested.json > .\TestResults\ctx-anyrun.log

Write-Host  "● Test1: scan-malware infected" -ForegroundColor Yellow -BackgroundColor DarkGreen
Write-Host

& $ethanolExe scan-malware -p .\Models\lightblue.mal -i .\ContextData\ctx-infected.json -o .\TestResults\ctx-infected.tested.json > .\TestResults\ctx-infected.log